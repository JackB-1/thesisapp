<manifest xmlns:android="http://schemas.android.com/apk/res/android">

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE"/>
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE_SPECIAL_USE" android:minSdkVersion="34"/>
    <uses-permission android:name="android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS"/>
    <uses-permission android:name="android.permission.WAKE_LOCK"/>
    <uses-permission android:name="android.permission.BLUETOOTH" android:maxSdkVersion="30"/>
    <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" android:maxSdkVersion="30"/>
    <uses-permission android:name="android.permission.BLUETOOTH_SCAN" /> 
    <uses-permission android:name="android.permission.BLUETOOTH_CONNECT"  />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_MEDIA_LOCATION" android:minSdkVersion="29"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" android:maxSdkVersion="28"/>
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" android:maxSdkVersion="28"/>
    <uses-permission android:name="android.permission.ACCESS_BACKGROUND_LOCATION" android:maxSdkVersion="29"/>
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
    <uses-feature android:name="android.hardware.bluetooth_le" android:required="true" />

    <application
      android:name=".MainApplication"
      android:label="@string/app_name"
      android:icon="@mipmap/ic_launcher"
      android:roundIcon="@mipmap/ic_launcher_round"
      android:allowBackup="true"
      android:supportsRtl="true"
      android:theme="@style/AppTheme">
      <!--allowBackup Changed to true to incorporate the functionality from the second manifest -->
      <!--supportsRtl Added from the second manifest -->
      <!-- Existing MainActivity from the first manifest -->
      <activity
        android:name=".MainActivity"
        android:label="@string/app_name"
        android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|screenSize|smallestScreenSize|uiMode"
        android:launchMode="singleTask"
        android:windowSoftInputMode="adjustResize"
        android:exported="true">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
      </activity>
      
      <!-- Additional activities from the second manifest -->
      <activity android:exported="true" android:name=".movesenseLog.MoveSenseLog"
                android:label="@string/app_name"
                android:icon="@drawable/ic_launcher"
                android:screenOrientation="portrait"
                android:theme="@style/Theme.AppCompat.NoActionBar">
      </activity>
      
      <activity android:exported="true" android:name=".movesenseLog.SettingsPage"
                android:screenOrientation="portrait"
                android:parentActivityName=".movesenseLog.MoveSenseLog" 
                android:theme="@style/Theme.AppCompat.NoActionBar">
      </activity>
      
      <activity android:exported="true" android:name=".movesenseLog.TermsOfUse"
                android:screenOrientation="portrait"
                android:parentActivityName=".movesenseLog.MoveSenseLog"
                android:theme="@style/Theme.AppCompat.NoActionBar">
      </activity>
      
      <!-- Foreground service declaration from the second manifest -->
      <service android:name=".movesenseLog.service.MoveSenseService" android:foregroundServiceType="specialUse">
        <property android:name="android.app.PROPERTY_SPECIAL_USE_FGS_SUBTYPE" android:value="Service to keep recording Movesense server in the background. The Movesene sensor can be used to record e.g. magneto-inertial signals and is not limited to any of the service type categories available. Connected device required runtime permissions that are not needed in the application and therefore did not apply."/>
      </service>

    </application>
</manifest>